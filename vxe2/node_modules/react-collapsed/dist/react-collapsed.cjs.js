"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var raf=_interopDefault(require("raf")),react=require("react");function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){_defineProperty(e,t,r[t])})}return e}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _iterableToArrayLimit(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var noop=function(){};function getElementHeight(e){return e&&e.current?e.current.scrollHeight:"auto"}var callAll=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.forEach(function(e){return e&&e.apply(void 0,r)})}},defaultTransitionStyles={transitionDuration:"500ms",transitionTimingFunction:"cubic-bezier(0.250, 0.460, 0.450, 0.940)"};function joinTransitionProperties(e){if(e){var t=["height"];return t.push.apply(t,_toConsumableArray(e.split(", "))),t.join(", ")}return"height"}function makeTransitionStyles(e){var t=e.expandStyles,r=void 0===t?defaultTransitionStyles:t,n=e.collapseStyles,o=void 0===n?defaultTransitionStyles:n;return{expandStyles:_objectSpread({},r,{transitionProperty:joinTransitionProperties(r.transitionProperty)}),collapseStyles:_objectSpread({},o,{transitionProperty:joinTransitionProperties(o.transitionProperty)})}}function useStateOrProps(e){var t=e.isOpen,r=e.defaultOpen,n=_slicedToArray(react.useState(r||!1),2),o=n[0];return[void 0!==t?t:o,n[1]]}function useEffectAfterMount(e,t){var r=react.useRef(!0);react.useEffect(function(){if(!r.current)return e();r.current=!1},t)}var idCounter=0,genId=function(){return++idCounter};function useUniqueId(){var e=_slicedToArray(react.useState(null),2),t=e[0],r=e[1];return react.useEffect(function(){return r(genId())},[]),t}function useCollapse(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=useUniqueId(),r=react.useRef(null),n=_slicedToArray(useStateOrProps(e),2),o=n[0],i=n[1],a="".concat(e.collapsedHeight||0,"px"),u=react.useMemo(function(){return{display:"0px"===a?"none":"block",height:a,overflow:"hidden"}},[a]),l=react.useMemo(function(){return makeTransitionStyles(e)},[e]),c=l.expandStyles,s=l.collapseStyles,f=_slicedToArray(react.useState(o?{}:u),2),p=f[0],d=f[1],y=_slicedToArray(react.useState(o),2),h=y[0],b=y[1],g=react.useCallback(function(){return i(function(e){return!e})},[]);useEffectAfterMount(function(){raf(o?function(){b(!0),d(function(e){return _objectSpread({},e,c,{willChange:"height",display:"block",overflow:"hidden"})}),raf(function(){var e=getElementHeight(r);d(function(t){return _objectSpread({},t,{height:e})})})}:function(){var e=getElementHeight(r);d(function(t){return _objectSpread({},t,s,{willChange:"height",height:e})}),raf(function(){d(function(e){return _objectSpread({},e,{height:a,overflow:"hidden"})})})})},[o]);var v=function(e){if(e.target===r.current)if(o){var t=getElementHeight(r);t===p.height?d({}):d(function(e){return _objectSpread({},e,{height:t})})}else p.height===a&&(b(!1),d(u))};return{getToggleProps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.disabled,n=void 0!==r&&r,i=e.onClick,a=void 0===i?noop:i,u=_objectWithoutProperties(e,["disabled","onClick"]);return _objectSpread({type:"button",role:"button",id:"react-collapsed-toggle-".concat(t),"aria-controls":"react-collapsed-panel-".concat(t),"aria-expanded":o?"true":"false",tabIndex:0},u,{onClick:n?noop:callAll(a,g)})},getCollapseProps:function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.style,a=void 0===i?{}:i,u=n.onTransitionEnd,l=void 0===u?noop:u,c=n.refKey,s=void 0===c?"ref":c,f=_objectWithoutProperties(n,["style","onTransitionEnd","refKey"]);return _objectSpread({id:"react-collapsed-panel-".concat(t),"aria-hidden":o?null:"true"},f,(_defineProperty(e={},s,r),_defineProperty(e,"onTransitionEnd",callAll(v,l)),_defineProperty(e,"style",_objectSpread({},defaultTransitionStyles,a,{transitionProperty:joinTransitionProperties(a.transitionProperty)},p)),e))},isOpen:o,toggleOpen:g,mountChildren:h}}module.exports=useCollapse;
//# sourceMappingURL=react-collapsed.cjs.js.map
